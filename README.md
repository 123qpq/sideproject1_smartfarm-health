# sideproject1_smartfarm-health

# 요약


  앱-서버-아두이노 형태로 연결했습니다.
  
  
  아두이노에서 데이터를 서버로 보내 저장하고 앱에서 서버의 정보를 불러옵니다.
  
  
  서버는 rest api 형태로 제작하였습니다. 서버는 NCP(NAVER CLOUD PLATFORM) 을 사용했습니다.
  
  
  첫 프로젝트라 보안과 효율성에 문제가 있을 수 있습니다.
  
  

# accounts


  계정에 관한 정보를 담고 있습니다.
  
  
  JWT를 사용하고 싶었으나 아직 제대로 활용하지 못해서 단순히 POST 방식으로 아이디와 비밀번호를 입력받습니다.
  
  
  SIGN IN 과 SIGN UP 기능이 있습니다.


# healthqpi


  post 형식으로 아두이노가 json데이터를 전송해주면 알맞게 파싱하여 db에 저장합니다.
  /post HTTP/1.1 { "user": "", "temperature": "", "heartrate": "", "datetime": ""}
  user 로 누구의 데이터인지 판별하고 체온, 심박수, 시간 의 정보를 얻습니다.
  만약 심박수가 60 이하로 떨어면 fcm을 통해 사용자에게 알림을 전송합니다.
  
  
  권한이 있는 사용자(주치의)는 db에 접근해 환자분의 과거 신체 이력을 볼 수 있습니다.
  환자 본인은 어플을 통해 자신의 실시간 정보를 휴대폰에서 확인할 수 있습니다.
  GET 방식으로 데이터를 요청하면 서버는 json 형식으로 데이터를 넘겨줍니다.
  
  
  아직 프레임워크 사용이 익숙치않아 url이 난잡합니다. 
  사용자 token 도 get 방식으로 받고있기 때문에 보안에도 취약합니다. 
  
  
  
  # farmapi
  
  
  post 형식으로 아두이노가 json 데이터를 전송해주면 알맞게 파싱하여 db에 저장합니다.
  /post HTTP/1.1 {"farmid": "", "moisture": "", "temperature": "", "humidity": "", "barometric":"", "altitude" : "", "datetime" : ""}
  farmid로 어느 농장의 데이터인지 판별하고 온도, 습도, 기압 등의 정보를 얻습니다.
  만약 습도가 60 이하로 떨어지면 fcm을 통해 사용자에게 알림을 전송합니다.
  
  
  사용자는 알림을 확인하고 스프링쿨러를 켤지 말지 결정할 수 있습니다. 
  get 방식으로 스프링 쿨러의 상태, on/off제어가 가능합니다.
  아두이노는 주기적으로 데이터를 전송함과 동시에 서버의 스프링쿨러 상태를 확인합니다.
  view.py에서 스프링쿨러의 상태를 읽는 기능을 따로 구현한 이유는 아두이노에서 약간의 결함이 발생했기 때문입니다.
  (아두이노로 json 데이터를 읽을 때 데이터 일부가 소실되는 문제가 있었습니다.)
  따라서 단순히 http 응답만으로 스프링쿨러의 상태를 판단할 수 있도록 만들었습니다.
  
  
  아직 프레임워크 사용이 익숙치 않아 farmapi와 같은 문제점을 갖고 있습니다.
  또한 app(장고의 application 단위)간의 db관계를 연결하는 방법을 찾지 못해 account와 독립적으로 동작합니다.
  
  
  
  
  
  
